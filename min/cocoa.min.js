function showTargetMessage(){loadTargetMsg(),msgTrackEvent()}function loadTargetMsg(){var e={title:"影响区域：",list:""},t="http://127.0.0.1:8080/dss-data/gisInfo/gis-info!getTownListByGemotry.action?geomtry="+lastPolygonVertices;$.ajax({type:"GET",url:t,success:function(t){e.list=t,T().clearCompsById(["yjddDiv"]),targetMsgComp.init("yjddDiv",["短信","大喇叭"],"其他",e)}})}function msgTrackEvent(){$("#msgMinMax").unbind(),$("#msgMaxClose").unbind(),$("#msgMinClose").unbind(),$("#msgMinMax").click(function(){T().clearCompsById(["trackMin"]),$("#msgMin").hide(),$("#msgMax").show(),targetTrackComp.initMax("trackMax")}),$("#msgMaxClose").click(function(){T().clearCompsById(["tragetType","tragetKind","tragetChose"]),$("#msgMax").hide(),targetTrackComp.clearTrackInterval()}),$("#msgMinClose").click(function(){T().clearCompsById(["trackMin"]),$("#msgMin").hide(),targetTrackComp.clearTrackInterval()}),mouse4MoveRainWindow("msgMaxTitle","msgMax")}var buttonComp={init:function(e,t,a){var n=T().CDE("div");T(n).setClass(t);var i=e.list;for(var r in i){var s=T().CDE("button");s.setAttribute("value",i[r].value),s.innerHTML=i[r].text,n.appendChild(s)}return a&&T(n).click(function(e){return a(T(e).getEventTarget(e).attributes.value.value)}),n}},checkBoxComp={init:function(e,t){var a=T().CDE("div");a.setAttribute("class","marTpad");var n=e.list,i=[];if("undefined"!=typeof e.defaultChecked&&(i=e.defaultChecked),"undefined"!=typeof e.title){var r=T().CDE("label");r.setAttribute("class","marR10"),r.innerHTML=e.title,a.appendChild(r)}var s=[],l=[];for(var o in n){var d=T().CDE("input");if(-1!==i.indexOf(n[o].value)){d.setAttribute("checked","checked"),d.setAttribute("status","selected");var c=new Object({});c.value=n[o].value,c.text=n[o].text,s.push(c),l.push(d)}else d.setAttribute("status","");d.setAttribute("type","checkbox"),d.setAttribute("value",n[o].value),d.setAttribute("text",n[o].text);var u=document.createElement("span");u.setAttribute("class","marR10"),u.innerHTML=n[o].text,a.appendChild(d),a.appendChild(u)}this.defaultSelect=l,T(a).click(function(e){var n=(T(e).getEventTarget(),cIobj.nodeName),i="",r="",s=!0,l=null,o=null;if("INPUT"===n){var d=cIobj.attributes.status;l=cIobj,"selected"===d.value?(d.value="",s=!1):d.value="selected","undefined"!=typeof l.attributes.blindComp&&(o=l.attributes.blindComp),i=cIobj.attributes.value.value,r=cIobj.attributes.text.value;var c=[],u=a.children;for(var p in u)if("INPUT"===u[p].nodeName&&"selected"===u[p].attributes.status.value){var m=new Object({}),v=u[p].attributes.value.value,f=u[p].attributes.text.value;m.id=v+f,m.value=v,m.text=f,m.obj=l,m.blindComp=o,c.push(m)}var g={checkBox:c};if(a.attributes.tempdatas=g,t){var h={};return h.id=i+r,h.value=i,h.text=r,h.obj=l,h.blindComp=o,h.checked=s,t(h)}}});var p={checkBox:s};return a.attributes.tempdatas=p,this.boxDiv=a,a},blindTo:function(e,t){for(var a=this.boxDiv.getElementsByTagName("input"),n=a.length-1;n>=0;n--)if(a[n].getAttribute("value")===t){a[n].attributes.blindComp=e;break}}};!function(){var e=window.T=function(t){return e.fn.init(t)};e.fn=e.prototype={elem:"",init:function(e){return this.elem=e,this},mousemove:function(t){return this.coEvent("mousemove",t),e.fn},mousedown:function(t){return this.coEvent("mousedown",t),e.fn},mouseup:function(t){return this.coEvent("mouseup",t),e.fn},mouseout:function(t){return this.coEvent("mouseout",t),e.fn},mouseover:function(t){return this.coEvent("mouseover",t),e.fn},click:function(e){this.coEvent("click",e)},coEvent:function(e,t){this.elem.addEventListener?this.elem.addEventListener(e,function(e){return t(e)},!1):this.elem.attachEvent&&this.elem.attachEvent("on"+e,function(e){return t(e)})},appendTo:function(t){e.fn.insertAdjacentElement(this.elem,"afterend",t)},insertTo:function(t){if(t.attributes.mulComp=!0,"undefined"!=typeof t.attributes.compList){var a=t.attributes.compList;-1===a.indexOf(this.elem)&&a.push(this.elem)}else{var n=[];n.push(this.elem),t.attributes.compList=n}e.fn.insertAdjacentElement(this.elem,"beforeend",t)},remove:function(){this.elem.parentNode.removeChild(this.elem)},insertAdjacentElement:function(e,t,a){"beforebegin"===t?a.parentNode.insertBefore(e,a):"afterbegin"===t?a.insertBefore(e,a.firstChild):"beforeend"===t?a.appendChild(e):"afterend"===t&&(a.nextSibling?a.parentNode.insertBefore(e,a.nextSibling):a.parentNode.appendChild(e))},getEventTarget:function(){return this.elem=this.elem?this.elem:window["this"].elem,this.elem.srcElement?this.elem.srcElement:this.elem.target},CDE:function(e){return document.createElement(e)},setClass:function(e){this.elem.setAttribute("class",e)},CAT:function(){return this.elem.attributes},addComps:function(t,a,n,i){var r=document.getElementById(this.elem),s=e().CDE("div");for(var l in t)t[l].hidden=!1,s.appendChild(t[l]);if(r.appendChild(s),a){var o=r.children[0].childNodes;e(a).click(function(t){var r=e(t).getEventTarget().attributes.value.value;if(""!==n&&null!==n)if(r===n){var s={};for(var l in o)if(o[l]!==a&&"length"!==l&&"item"!==l&&"undefined"!=typeof o[l].attributes){if("undefined"!=typeof o[l].attributes.mulComp){console.info(o[l]);var d=o[l].attributes.compList;for(var c in d){var u=d[c].attributes.tempdatas;for(var p in u)s[p]=u[p]}}var m=o[l].attributes.tempdatas;for(var v in m)s[v]=m[v]}if(i)return i(s)}else if(i)return i(r)})}},compRecord:function(e,t){if("undefined"!=typeof this.elem){var a=this.elem;a[e]=t,this.elem=a}else{var n={};n[e]=t,this.elem=n}return this.elem},clearCompsById:function(e){if(e instanceof Array)for(var t in e){var a=document.getElementById(e[t]).childNodes[0];if("undefined"!=typeof a){for(var n=a.childNodes,i=n.length-1;i>=0;i--)n[i].hidden=!0;document.getElementById(e[t]).removeChild(a)}}else if("undefined"!=typeof document.getElementById(e).childNodes[0])for(var r=document.getElementById(e).childNodes[0].childNodes,s=r.length-1;s>=0;s--)r[s].hidden=!0,document.getElementById(e).removeChild(r[s])},getCompsDataById:function(t,a){t&&e(t).click(function(e){var n=[];for(var i in this.elem)if("undefined"!=typeof document.getElementById(this.elem[i]).children[0]){var r=document.getElementById(this.elem[i]).children[0].childNodes[0];n.push(r)}var s={};for(var l in n)if(n[l]!==t&&"length"!==l&&"item"!==l&&null!==n[l]){var o=n[l].attributes.tempdatas;for(var d in o)s[d]=o[d]}a&&a(s)})}}}(Window);var pagingComp={init:function(e,t,a){"undefined"!=typeof this.pageE&&this.pageE[e]&&T(this.pageE[e]).remove(),this.focusId=e,this.bgIndex=0,this.endIndex=a,this.pCount=a,this.currPage=1,this.allPage=(t.length-(t.length%a===0?-a:t.length%a))%a,this.arrComps=t;var n=t.length;this.compsLength=n,n%a===0?this.allPage=n/a:this.allPage=(n-n%a)/a+1,pagingComp.startPage();var i=document.getElementById(e),r=pagingComp.pageButton();if(T(r).appendTo(i),"undefined"!=typeof this.pageButton){var s=this.pageButton;s[this.focusId]=r,this.pageButton=s;var l=this.getPageComp;l[this.focusId]=i,this.getPageComp=l}else{var o={},d={};o[this.focusId]=r,d[this.focusId]=i,this.pageButton=o,this.getPageComp=d}},startPage:function(){T().clearCompsById([this.focusId]);var e=[],t=this.endIndex;t>this.compsLength&&(t=this.compsLength);for(var a=this.bgIndex;t>a;a++)this.arrComps[a].hidden=!1,e.push(this.arrComps[a]);T(this.focusId).addComps(e)},pageButton:function(){var e=document.createElement("div");e.style.display="inline-block",e.style.width="100%";var t=document.createElement("div");t.style["float"]="left",t.style.marginLeft="20px";var a=document.createElement("span");a.innerHTML="第1页/共"+this.allPage+"页 "+this.compsLength+"条记录",t.appendChild(a);var n=document.createElement("div");n.style["float"]="left",n.style["float"]="right",n.style.marginRight="20px";var i=document.createElement("span");i.innerHTML="上一页",i.style.cursor="default",i.style.color="#9d9d9d",i.style.marginRight="10px",i.onclick=function(){if(1!==pagingComp.currPage){i.style.color="black",r.style.color="black",r.style.cursor="pointer";var e=parseInt(pagingComp.bgIndex)-parseInt(pagingComp.pCount),t=parseInt(pagingComp.endIndex)-parseInt(pagingComp.pCount),n=parseInt(pagingComp.currPage)-parseInt("1");pagingComp.currPage=n,pagingComp.bgIndex=e,pagingComp.endIndex=t,pagingComp.startPage(),a.innerHTML="第"+n+"页/共"+pagingComp.allPage+"页 "+pagingComp.compsLength+"条记录",1===pagingComp.currPage&&(i.style.color="#9d9d9d",i.style.cursor="default")}else r.style.color="black"};var r=document.createElement("span");return r.innerHTML="下一页",r.style.cursor="pointer",r.onclick=function(){if(pagingComp.currPage!==pagingComp.allPage){i.style.color="black",i.style.cursor="pointer";var e=parseInt(pagingComp.bgIndex)+parseInt(pagingComp.pCount),t=parseInt(pagingComp.endIndex)+parseInt(pagingComp.pCount),n=parseInt(pagingComp.currPage)+parseInt("1");pagingComp.bgIndex=e,pagingComp.endIndex=t,pagingComp.currPage=n,pagingComp.startPage(),a.innerHTML="第"+n+"页/共"+pagingComp.allPage+"页 "+pagingComp.compsLength+"条记录",pagingComp.currPage===pagingComp.allPage&&(r.style.color="#9d9d9d",r.style.cursor="default")}else i.style.color="black"},n.appendChild(i),n.appendChild(r),e.appendChild(t),e.appendChild(n),this.pageE=T(this.pageE).compRecord(this.focusId,e),e},getPageButton:function(e){return this.pageButton[e]},getPageComp:function(e){return this.pageE[e]}},radioComp={init:function(e,t){var a=document.createElement("div");if(a.setAttribute("class","marTpad"),"undefined"!=typeof e.title){var n=document.createElement("label");n.setAttribute("class","marR10"),n.innerHTML=e.title,a.appendChild(n)}var i=e.list,r={};for(var s in i){var l=i[s].value,o=i[s].text,d=document.createElement("input");l===e.defaultChecked&&(d.setAttribute("checked","checked"),r.value=l,r.text=o),d.setAttribute("type","radio"),d.setAttribute("name",e.name),d.setAttribute("value",l),d.setAttribute("text",o);var c=document.createElement("span");c.setAttribute("class","marR10"),c.innerHTML=o,a.appendChild(d),a.appendChild(c)}T(a).click(function(e){var n=T(e).getEventTarget(),i=n.nodeName;if("INPUT"===i){r.value=n.attributes.value.value,r.text=n.attributes.text.value;var s={radio:r};if(a.attributes.tempdatas=s,t)return t(s)}});var u={radio:r};return a.attributes.tempdatas=u,a}},selectComp={init:function(e,t,a){var n=parseInt(e)+36,i=parseInt(e)+34,r=T().CDE("div");r.style.width=n+"px",r.style.position="relative",r.style.zIndex="10000",r.style.margin="0",r.style.padding="0",r.style.fontSize="13px";var s=T().CDE("cite");s.innerHTML=t.cite,s.style.width=e+"px",s.style.height="24px",s.style.lineHeight="24px",s.style.display="block",s.style.color="#807a62",s.style.cursor="pointer",s.style.fontStyle="normal",s.style.paddingLeft="4px",s.style.paddingRight="30px",s.style.border="1px solid #333",s.style.overflowX="hidden",s.style.background="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAMCAMAAABcOc2zAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAJUExURXt7e3p6ev////MnDfwAAAADdFJOU///ANfKDUEAAAAiSURBVHjaYmBCAwzUEWCAACQVyHyIFgYGRjQzGCiyFiDAAI3WAWIk9jYnAAAAAElFTkSuQmCC) no-repeat right center";var l=T().CDE("ul");l.style.maxHeight="193px",l.style.overflowY="scroll",s.onclick=function(e){e.stopPropagation(e),"none"===l.style.display?l.style.display="block":l.style.display="none"},document.body.onclick=function(e){l.style.display="none"},l.style.margin="-1px 0px 0px",l.style.padding="0px",l.style.fontSize="13px",l.style.width=i+"px",l.style.border="1px solid #333333",l.style.position="absolute",l.style.zIndex="20000",l.style.display="none",l.style.backgroundColor="#ffffff";var o=t.list,d="",c="";for(var u in o){var p=T().CDE("li");p.style.height="24px",p.style.lineHeight="24px",p.style.listStyle="none",p.style.margin="0px",p.style.padding="0px",p.style.fontSize="13px",p.style.width="100%";var m=T().CDE("span");m.setAttribute("value",o[u].value),m.innerHTML=o[u].text,m.style.background="#fff",m.style.display="block",m.style.height="24px",m.style.color="#333",m.style.textDecoration="none",m.style.paddingLeft="10px",m.style.paddingRight="10px",p.appendChild(m),l.appendChild(p),"undefined"!=typeof t.defaultCheck&&""!==t.defaultCheck&&t.defaultCheck===o[u].value&&(s.innerHTML=o[u].text,d=o[u].value,c=o[u].text)}T(l).mouseover(function(e){var t=T(e).getEventTarget();"SPAN"===t.nodeName&&(t.style.background="#ccc")}).mouseout(function(e){var t=T(e).getEventTarget();"SPAN"===t.nodeName&&(t.style.background="#fff")}).click(function(e){var n=T(e).getEventTarget().nodeName;if("SPAN"===n){l.style.display="none";var i=T(e.target).CAT().value.value,o=e.target.innerHTML;s.innerHTML=o;var d={value:i,text:o},c=new Object({});if(c.id=t.id,c.value=i,c.text=o,T(r).CAT().tempdatas=T(T(r).CAT().tempdatas).compRecord("select"+t.id,c),a)return a(d)}});var v=new Object({}),f="select"+t.id;if(v.id=t.id,v.value=d,v.text=c,r.appendChild(s),r.appendChild(l),"undefined"!=typeof t.title){var g=T().CDE("div");T(g).setClass("marTpad"),g.style.display="inline-block";var h=T().CDE("label");T(h).setClass("marR10"),h.style["float"]="left",h.innerHTML=t.title,r.style["float"]="left",g.appendChild(h),g.appendChild(r),r=g}else r.style["float"]="left";return T(r).CAT().tempdatas=T(T(r).CAT().tempdatas).compRecord(f,v),r}},textAreaComp={init:function(e){var t=document.createElement("div");t.setAttribute("class","messageBox");var a=document.createElement("label");a.setAttribute("class","MBlabel"),""!==e&&(a.innerHTML=e+"：");var n=document.createElement("div");n.setAttribute("class","messageBox-textarea");var i=document.createElement("textarea");i.setAttribute("class","paddLR10"),i.setAttribute("rows","3"),i.setAttribute("cols","30"),i.style.width="100%",i.style.height="100%",i.onblur=function(){var a={};a["textarea"+e]=i.value,t.attributes.tempdatas=a};var r={};return r["textarea"+e]="",t.attributes.tempdatas=r,n.appendChild(i),t.appendChild(a),t.appendChild(n),t}},windowDragComp={init:function(e,t,a){var n=T().CDE("div");n.setAttribute("class","wdc-parent"),n.style.position="absolute",n.style.left=e.wx+"px",n.style.top=e.wy+"px",n.style.width="400px",n.style.height="100px";var i=T().CDE("div");i.style.cursor="pointer",i.setAttribute("class","wdc-dragTitle");var r=T().CDE("span");r.innerHTML=e.title,i.appendChild(r);var s=T().CDE("div");s.style.cursor="default",n.appendChild(i),n.appendChild(s),document.body.appendChild(n),this.parentE=T(this.parentE).compRecord(e.id,n),this.addDrag(i,n)},remove:function(){this.parentE&&T(this.parentE).remove()},addDrag:function(e,t){e=e||t,e.style.cursor="move",e.onmousedown=function(e){e=e||window.event,t.style.zIndex="999999";var a=e.clientX-t.offsetLeft,n=e.clientY-t.offsetTop;return document.onmousemove=function(e){e=e||window.devent;var i=e.clientX-a,r=e.clientY-n,s=document.documentElement.clientWidth-t.offsetWidth,l=document.documentElement.clientHeight-t.offsetHeight;return i=0>=i?0:i,r=0>=r?0:r,i=i>=s?s:i,r=r>=l?l:r,t.style.left=i+"px",t.style.top=r+"px",!1},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,t.style.zIndex="99999"},!1}}},browerVComp={init:function(e){var t=document.createElement("div");t.setAttribute("class","version-box");var a=document.createElement("div");a.setAttribute("class","bvDivTitle-1");var n=document.createElement("span");n.innerHTML="版本推荐";var i=document.createElement("p");a.appendChild(n),a.appendChild(i),i.setAttribute("class","bvclose"),i.onclick=function(){return browerVComp.close(),e?e(!0):void 0};var r=document.createElement("div");r.setAttribute("class","version-con"),t.appendChild(a),t.appendChild(r);var s=document.createElement("div");s.setAttribute("class","vesion-left");var l=document.createElement("img");s.appendChild(l);var o=document.createElement("div");o.setAttribute("class","vesion-right");var d=document.createElement("div");d.setAttribute("class","clear"),r.appendChild(s),r.appendChild(o),r.appendChild(d);var c=document.createElement("p");c.setAttribute("class","version-title"),c.innerHTML="浏览器版本推荐";var u=document.createElement("div");u.setAttribute("class","version-option"),o.appendChild(c),o.appendChild(u);var p=document.createElement("ul");u.appendChild(p);var m=document.createElement("li");m.innerHTML="IE10及以上版本";var v=document.createElement("li");v.innerHTML="火狐38.0.1及以上版本";var f=document.createElement("li");f.innerHTML="谷歌42.0.2311.152及以上版本";var g=document.createElement("li");g.innerHTML="360安全浏览器7.1.1及以上版本";var h=document.createElement("li");h.innerHTML="360极速浏览器7.5.3.318及以上版本",p.appendChild(m),p.appendChild(v),p.appendChild(f),p.appendChild(g),p.appendChild(h),l.setAttribute("src",""),document.body.appendChild(t),this.parentE=t},close:function(){"undefined"!=typeof this.parentE&&T(this.parentE).remove()}},effectAreaComp={init:function(e){var t=document.createElement("div");if(T(t).setClass("influenceArea marTpad"),"undefined"!=typeof e.title){var a=document.createElement("label");T(a).setClass("EAlabel marR10"),a.innerHTML=e.title,t.appendChild(a)}var n=document.createElement("div");T(n).setClass("influenceArea-box");var i=document.createElement("ul");T(i).setClass("influenceArea-box-ul");var r=e.list,s="";for(var l in r){var o=document.createElement("li");T(o).setClass("influenceArea-box-ul-li"),o.setAttribute("value",r[l].value),o.setAttribute("text",r[l].text),s+=r[l].value+",";var d=document.createElement("a");T(d).setClass("influenceArea-box-ul-li-a"),d.innerHTML=r[l].text;var c=document.createElement("i");T(c).setClass("influenceArea-box-ul-li-a-i"),c.setAttribute("value",r[l].value),c.innerHTML="x",d.appendChild(c),o.appendChild(d),i.appendChild(o)}T(i).click(function(e){var a=T(e).getEventTarget();if("I"===a.nodeName){var n=a.parentElement.parentElement;if("undefined"!=typeof n.attributes.value){var i=n.attributes.value.value,r=t.attributes.tempdatas.areaList;r=r.replace(i+",",""),t.attributes.tempdatas.areaList=r,T(n).remove()}}}),n.appendChild(i),t.appendChild(n);var u={areaList:s};return t.attributes.tempdatas=u,t}},targetMsgComp={init:function(e,t,a,n){function i(e){if(e.checked){var t=textAreaComp.init(e.text);T(t).appendTo(g),checkBoxComp.blindTo(t,e.value)}else"undefined"!=typeof e.blindComp&&T(e.blindComp).remove()}function r(e){var t={cite:"请选择种类",id:"kind",defaultCheck:"",list:""},a={typeCode:e.value};$.ajax({type:"GET",async:!1,data:a,url:"http://127.0.0.1:8080/dss-data/target/target!getDemagesKindByType.action",success:function(e){t.list=e}}),I&&T(I).remove(),t.list.length>0&&(I=selectComp.init("100",t),T(I).insertTo(p))}function s(e){if("reset"===e)loadTargetMsg();else{var t="";if(""===e.textareaLED显示屏&&(t="请填写LED显示屏消息内容"),""===e.textarea大喇叭&&(t="请填写大喇叭消息内容"),""===e.textarea短信&&(t="请填写短信消息内容"),""===e.areaList&&(t="影响区域不能为空"),"undefined"!=typeof e.selectkind&&""===e.selectkind.text&&(t="请选择灾害种类"),""===e.selecttype.text&&(t="请选择灾害类型"),"undefined"==typeof e.checkBox[0]&&(t="请选择消息渠道"),""===t){var a="",n="",i="",r="";"19000"===e.selecttype.value?(a="",r=""):(a=e.selectkind.value,r=e.selectkind.text),n=e.selecttype.value,i=e.selecttype.text;var s="http://127.0.0.1:8080/dss-data/target/target!sendMsg.action",l="",o="";for(var d in e.checkBox){var c=e.checkBox[d].text;l+=c+",","短信"===c?o+="短信:"+e.textarea短信+"|":"大喇叭"===c?o+="大喇叭:"+e.textarea大喇叭+"|":"LED显示屏"===c&&(o+="LED显示屏:"+e.textareaLED显示屏+"|")}o=encodeURI(o),l=encodeURI(l),i=encodeURI(i),r=encodeURI(r);var u={areaCode:cityCode,msgWay:l,typeName:i,kindName:r,demageType:n,demageKind:a,demageLevel:e.radio.value,effectArea:e.areaList,wayContent:o};$.ajax({type:"GET",async:!1,data:u,url:s,success:function(e){targetTrackComp.initMin("trackMin",e),$("#msgMin").show(),$("#information_issuing").hide()}})}else C.innerHTML=t}}var l={title:"消息渠道：",defaultChecked:[],list:[{value:"1",text:"短信"},{value:"2",text:"大喇叭"},{value:"3",text:"LED显示屏"}]};if(t instanceof Array){var o=[];for(var d in l.list)-1!==t.indexOf(l.list[d].text)&&o.push(l.list[d].value);l.defaultChecked=o}var c=checkBoxComp.init(l,i);c.setAttribute("class","marTpad");var u={title:"灾害类型：",cite:"请选择类型",id:"type",defaultCheck:"",list:""};$.ajax({type:"GET",async:!1,url:"http://127.0.0.1:8080/dss-data/target/target!getDemagesType.action",success:function(e){u.list=e}});var p=selectComp.init("100",u,r),m={title:"灾害等级：",name:"warnLevel",defaultChecked:"6",list:[{value:"1",text:"红"},{value:"2",text:"橙"},{value:"3",text:"黄"},{value:"4",text:"蓝"},{value:"5",text:"白"},{value:"6",text:"其他"}]};if("string"==typeof a)for(var v in m.list)if(-1!==a.indexOf(m.list[v].text)){m.defaultChecked=m.list[v].value;break}var f=radioComp.init(m),g=effectAreaComp.init(n),h=document.createElement("div"),C=document.createElement("span");C.setAttribute("class","paddLR10 alarmColor"),C.style["float"]="left",C.innerHTML="",h.appendChild(C);var y={list:[{value:"reset",text:"重置"},{value:"send",text:"发送"}]},b=buttonComp.init(y,"tempTarget-btn");T(e).addComps([c,p,f,g,h,b],b,"send",s);var x=l.list;for(var E in x){var A=x[E].value;if(-1!==l.defaultChecked.indexOf(A)){var k=textAreaComp.init(x[E].text);checkBoxComp.blindTo(k,x[E].value),T(k).appendTo(g)}}var I=null}},targetTrackComp={initMin:function(e,t){var a="http://127.0.0.1:8080/dss-data/track/track!getTrackMsgById.action",n={idArray:t.toString()};$.ajax({type:"GET",async:!1,data:n,url:a,success:function(t){var a=[];for(var n in t)a.push(trackComp.init(t[n]));T(e).addComps(a)}})},initMax:function(e){function t(t){var a="";if(""===t.selectdemageType.text?a="请选择查询类型":""===t.selectdemageContent.text&&(a="请选择查询内容"),l.innerHTML=a,""===a){var n=t.selectdemageType.text,i=t.selectdemageContent.text,r="";"渠道"===n?r="receiver='"+i+"'":"灾害"===n?(-1!==i.indexOf("预警")&&(-1!==i.indexOf("红色")?i="1":-1!==i.indexOf("橙色")?i="2":-1!==i.indexOf("黄色")?i="3":-1!==i.indexOf("蓝色")?i="4":-1!==i.indexOf("白色")?i="5":-1!==i.indexOf("其他")&&(i="6")),r="kind_name='"+i+"' or type_name = '"+i+"' or warn_level = '"+i+"'"):"内容"===n&&(r="content like '%"+i+"%';");var s="http://127.0.0.1:8080/dss-data/track/track!getTrackMsgByFilter.action";r=encodeURI(r);var o={sql:r};$.getJSON(s,o,function(t){var a=[];for(var n in t)a.push(trackComp.init(t[n]));pagingComp.init(e,a,6)})}}function a(e){var t={cite:"请选择内容",id:"demageContent",defaultCheck:"",list:""},a=e.text;a=encodeURI(a);var n="http://127.0.0.1:8080/dss-data/target/target!getTypeByFilter.action",i={filter:a};$.getJSON(n,i,function(e){t.list=e,T().clearCompsById(["tragetKind"]);var a=selectComp.init("100",t);T("tragetKind").addComps([a])})}T().clearCompsById(["trackMax","tragetType","tragetKind","tragetChose"]);var n={cite:"请选择类型",id:"demageType",defaultCheck:"",list:[{value:"1",text:"渠道"},{value:"2",text:"灾害"},{value:"3",text:"内容"}]},i=selectComp.init("100",n,a);T("tragetType").addComps([i]);var r={list:[{value:"sure",text:"确定"}]},s=buttonComp.init(r,"msgTrack-btn");s.style["float"]="left",T("tragetChose").addComps([s]),T(["tragetType","tragetKind"]).getCompsDataById(s,t);var l=document.createElement("span");l.setAttribute("class","paddLR10 alarmColor"),l.style["float"]="left",l.style.marginTop="3px",l.innerHTML="",T(l).appendTo(s);var o="http://127.0.0.1:8080/dss-data/track/track!getAllTrackMsgByCode.action",d={areaCode:cityCode};$.ajax({type:"GET",data:d,url:o,success:function(t){var a=[];for(var n in t)a.push(trackComp.init(t[n]));pagingComp.init(e,a,6)}})},clearTrackInterval:function(){trackComp.clearTrackInterval()}},trackComp={init:function(e){var t=document.createElement("div");t.hidden=!0,t.setAttribute("class","inforTracking-box");var a=document.createElement("ul"),n=e.list,i={};for(var r in n){var s=document.createElement("li");s.innerHTML=n[r].text;var l=document.createElement("span");if(l.innerHTML=n[r].value,s.appendChild(l),"日期："===n[r].text){var o=document.createElement("span");o.setAttribute("class","floatR10"),o.style.color="red",s.appendChild(o),i[e.id]=t,t.belongsChild=o,o.attributes.msg=e.msg,o.attributes.msgId=e.id,o.attributes.status=e.status,this.compsRecord=T(this.compsRecord).compRecord(e.id,t)}a.appendChild(s)}"undefined"!=typeof this.intervals&&clearInterval(this.intervals);var d="http://127.0.0.1:8080/dss-data/track/track!getTrackMsgById.action",c=setInterval(function(){var e=[];for(var t in trackComp.compsRecord)if(!trackComp.compsRecord[t].hidden){var a=trackComp.compsRecord[t].belongsChild;"0"===a.attributes.status&&e.push(a.attributes.msgId)}var n={idArray:e.toString()};$.ajax({type:"GET",data:n,url:d,success:function(e){for(var t in trackComp.compsRecord)if(!trackComp.compsRecord[t].hidden){var a=trackComp.compsRecord[t].belongsChild;if("0"===a.attributes.status)for(var n in e)if(e[n].id===a.attributes.msgId){a.innerHTML=e[n].msg,a.attributes.status=e[n].status;break}}}})},5e3);return t.appendChild(a),this.intervals=c,t},initTrackStatus:function(e){for(var t in e)console.info(!e[t].hidden);trackComp.compsRecord=e},clearTrackInterval:function(){clearInterval(this.intervals)}};